tit <- as.data.frame(Titanic)
getwd()
load_all("..")
library(devtools)
load_all("..")
tit2d <- aggregate( Freq ~ Class + Survived, data=tit, sum)
alluvial( tit2d[,1:2], freq=tit2d$Freq, xw=0.0, alpha=0.8,
gap.width=0.1, col= "steelblue", border="white",
layer = tit2d$Survived != "Yes" )
alluvial( tit2d[,1:2], freq=tit2d$Freq,
hide=tit2d$Freq < 150,
xw=0.0, alpha=0.8,
gap.width=0.1, col= "steelblue", border="white",
layer = tit2d$Survived != "Yes" )
tit3d <- aggregate( Freq ~ Class + Sex + Survived, data=tit, sum)
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
col=ifelse( tit3d$Survived == "No", "red", "gray"),
layer = tit3d$Sex != "Female",
border="white")
alluvial( tit[,1:4], freq=tit$Freq, border=NA,
hide = tit$Freq < quantile(tit$Freq, .50),
col=ifelse( tit$Class == "3rd" & tit$Sex == "Male", "red", "gray") )
for (blocks in c(TRUE, FALSE, "bookends")) {
# Elaborate alluvial diagram from main examples file
alluvial( tit[, 1:4], freq = tit$Freq, border = NA,
hide = tit$Freq < quantile(tit$Freq, .50),
col = ifelse( tit$Class == "3rd" & tit$Sex == "Male",
"red", "gray" ),
blocks = blocks )
}
freq=tit$Freq
border=NA
hide=tit$Freq < quantile(tit$Freq, .5)
col=ifelse(tit$Class=="3rd" & tit$Sex == "Male","red", "gray")
blocks=FALSE
p <- data.frame( ..., freq=freq, col, alpha, border, hide, stringsAsFactors=FALSE)
p <- data.frame( tit[, 1:4], freq=freq, col, alpha, border, hide, stringsAsFactors=FALSE)
hide=FALSE
alpha=.5
gap.width=.05
xw=.1
cw=.1
p <- data.frame( tit[, 1:4], freq=freq, col, alpha, border, hide, stringsAsFactors=FALSE)
n <- nrow(p)
layer <- 1:n
p$layer <- layer
np <- ncol(p) - 6                    # Number of dimensions
d <- p[ , 1:np, drop=FALSE]          # Dimensions dframe
p <- p[ , -c(1:np), drop=FALSE]      # Parameteres dframe
p$freq <- with(p, freq/sum(freq))    # Frequencies (weights)
col <- col2rgb(p$col, alpha=TRUE)
if(!identical(alpha, FALSE)) {
col["alpha", ] <- p$alpha*256
}
p$col <- apply(col, 2, function(x) do.call(rgb, c(as.list(x), maxColorValue = 256)))
p
isch <- sapply(d, is.character)
d[isch] <- lapply(d[isch], as.factor)
if (length(blocks) == 1)
{
blocks <- if (!is.na(as.logical(blocks)))
{
rep(blocks, np)
} else if (blocks == "bookends")
{
c(TRUE, rep(FALSE, np - 2), TRUE)
}
}
blocks
tit[, 1:4]
p
d
dim(d)
d
p
library(dplyr)
tbl_cube
as.tbl_cube(tit[, 1:4])
tit[, 1:4]
tit3d
tit$Freq
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2,
col=ifelse( tit3d$Survived == "No", "red", "gray"),
layer = tit3d$Sex != "Female",
border="white")
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2,
col=ifelse( tit3d$Survived == "No", "red", "gray"),
layer = tit3d$Sex != "Female",
border="white")
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2, border="white")
levels(tit$Class)
tit[,1:4]
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2, border="white", alpha = .5)
alluvial(tit[,1:4], freq=tit$Freq, alpha=.5, xw=0.2, border="white")
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2)
alluvial(tit[,1:4], freq=tit$Freq, alpha=1)
alluvial(tit[,1:4], freq=tit$Freq)
alluvial(tit[,1:4], freq=tit$Freq, alpha=1, xw=0.2)
tit <- as.data.frame(Titanic)
library(alluvial)
tit3d <- aggregate( Freq ~ Class + Sex + Survived, data=tit, sum)
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
col=ifelse( tit3d$Survived == "No", "red", "gray"),
layer = tit3d$Sex != "Female",
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = tit3d$Sex != "Female",
border="white")
dim(tit3d)
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
border="white")
tit3d
# hiding the casualties
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
hide = tit3d$Survived == "No",
border="white")
# hiding the casualties
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
hide = tit3d$Survived == "No",
border="white")
# hiding the casualties
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
hide = tit3d$Survived == "No",
border="white")
# doing both results in randomizing the hiding as well
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
hide = tit3d$Survived == "No",
border="white")
# doing both results in randomizing the hiding as well
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
layer = sample(1:nrow(tit3d)),
hide = tit3d$Survived == "No",
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
hide = tit3d$Survived == "No",
border="white")
alluvial(tit3d[,1:3], freq=tit3d$Freq, alpha=1, xw=0.2,
hide = tit3d$Survived == "No",
border="white")
